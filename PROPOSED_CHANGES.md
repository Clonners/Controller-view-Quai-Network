Proposed initial improvements (AI assistant)

Priorities:
1. Fix obvious bugs/crashes found by quick static scan and tests.
2. Add or improve unit tests where missing.
3. Refactor for readability and maintainability.

Planned workflow:
- Run test suite and linters.
- Use Copilot CLI to suggest code changes for failing tests or TODOs.
- Apply changes, run tests locally.
- Push branch and open a Draft PR with detailed changelog and diffs.

This PR is a safe proposal; no changes to main branch will be made without your approval.
